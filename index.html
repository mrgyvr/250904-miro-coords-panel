<script type="module">
  if (!('miro' in window)) {
    // Hosted fine but opened outside Miro
    document.body.innerHTML = '<div style="font:14px system-ui; padding:16px;"><b>This page is meant to run inside a Miro board.</b><br>Open a board in the team where the app is installed.</div>';
  } else {
    try {
      // Register icon click â†’ open panel
      miro.board.ui.on('icon:click', () => {
        miro.board.ui.openPanel({ url: 'panel.html' });
      });
      // TEMP: auto-open once so we can see it working
      await miro.board.ui.openPanel({ url: 'panel.html' });
    } catch (e) {
      // If something throws, surface it visibly
      document.body.innerHTML = `<div style="font:14px system-ui; padding:16px; color:#b00020;">
        Failed to open panel: ${e?.message || e}
      </div>`;
    }
  }
</script>
