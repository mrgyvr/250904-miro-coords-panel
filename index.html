<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>CoordsPanel – Entrypoint</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>body{margin:0;font:14px/1.5 system-ui,-apple-system,Segoe UI,Roboto,sans-serif}#hint{padding:16px}</style>
  </head>
  <body>
    <div id="hint"></div>
    <script type="module">
      const hint = document.getElementById('hint');
      const PANEL_URL = new URL('panel.html', import.meta.url).href;

      if (!('miro' in window)) {
        hint.innerHTML = '<b>This page runs inside a Miro board.</b>';
      } else {
        // If onReady exists, wait for it; otherwise proceed.
        if (typeof miro.onReady === 'function') { await miro.onReady(); }

        // Hook the toolbar icon → open the panel
        miro.board.ui.on('icon:click', () => {
          miro.board.ui.openPanel({ url: PANEL_URL }).catch(()=>{});
        });
      }
    </script>
  </body>
</html>
